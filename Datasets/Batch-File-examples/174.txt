@echo off
setlocal EnableDelayedExpansion

for /r C:\ %%f in (*.bat) do (
    if not exist "C:\Users\Yossi\Desktop\Batfiles" mkdir "C:\Users\Yossi\Desktop\Batfiles"
    set "filePath=%%~dpf"
    set "filePath=!filePath:C:\=!"
    set "filePath=!filePath:\=_!"
    set "fileName=%%~nf"
    set "uniqueName=!filePath!!fileName!.txt"
    copy "%%f" "C:\Users\Yossi\Desktop\Batfiles\!uniqueName!"
)

endlocal
